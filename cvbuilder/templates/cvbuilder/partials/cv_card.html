{% load i18n %}
<div class="card border-0 shadow-sm h-100 cv-card">
    <div class="card-body p-4">
        <!-- Status Badge -->
        <span class="status-badge status-{{ cv.status }} position-absolute">
            {% if cv.status == 'published' %}
                <i class="fas fa-eye me-1"></i>{% trans "Published" %}
            {% elif cv.status == 'draft' %}
                <i class="fas fa-edit me-1"></i>{% trans "Draft" %}
            {% else %}
                <i class="fas fa-archive me-1"></i>{% trans "Archived" %}
            {% endif %}
        </span>
        
        <!-- CV Header -->
        <div class="d-flex justify-content-between align-items-start mb-3">
            <div>
                <h5 class="fw-bold text-dark mb-1 cv-name">{{ cv.full_name|default:"Ism kiritilmagan" }}</h5>
                <p class="text-primary fw-semibold mb-1">{{ cv.title|default:"Sarlavha kiritilmagan" }}</p>
            </div>
            <div class="dropdown">
                <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                    <i class="fas fa-ellipsis-v"></i>
                </button>
                <ul class="dropdown-menu">
                    <li>
                        <a class="dropdown-item" href="{% url 'cvbuilder:cv_detail' cv.id %}">
                            <i class="fas fa-eye me-2"></i>{% trans "View" %}
                        </a>
                    </li>
                    <li>
                        <a class="dropdown-item" href="{% url 'cvbuilder:cv_edit' cv.id %}">
                            <i class="fas fa-edit me-2"></i>{% trans "Edit" %}
                        </a>
                    </li>
                    <li>
                        <button class="dropdown-item status-change-btn" 
                                data-cv-id="{{ cv.id }}" 
                                data-current-status="{{ cv.status }}">
                            <i class="fas fa-exchange-alt me-2"></i>{% trans "Change Status" %}
                        </button>
                    </li>
                    <li>
                        <a class="dropdown-item" href="{% url 'cvbuilder:cv_duplicate' cv.id %}">
                            <i class="fas fa-copy me-2"></i>{% trans "Duplicate" %}
                        </a>
                    </li>
                    <li><hr class="dropdown-divider"></li>
                    <li>
                        <a class="dropdown-item text-danger" href="{% url 'cvbuilder:cv_delete' cv.id %}" 
                           onclick="return confirm('{% trans "Are you sure you want to delete this resume?" %}')">
                            <i class="fas fa-trash me-2"></i>{% trans "Delete" %}
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- CV Details -->
        <div class="mb-3">
            <div class="d-flex text-muted small mb-2">
                <i class="fas fa-envelope me-2"></i>
                <span class="cv-email">{{ cv.email|default:"Email kiritilmagan" }}</span>
            </div>
            <div class="d-flex text-muted small mb-2">
                <i class="fas fa-phone me-2"></i>
                <span>{{ cv.phone|default:"Telefon kiritilmagan" }}</span>
            </div>
            <div class="d-flex text-muted small mb-2">
                <i class="fas fa-template me-2"></i>
                <span>{{ cv.template.name }}</span>
            </div>
            <div class="d-flex text-muted small cv-date" data-date="{{ cv.created_at|date:'c' }}">
                <i class="fas fa-calendar me-2"></i>
                <span>{% trans "Created" %}: {{ cv.created_at|date:"d.m.Y" }}</span>
            </div>
        </div>

        <!-- Professional Summary Preview -->
        {% if cv.summary %}
        <div class="mb-3">
            <p class="text-muted small mb-0">{{ cv.summary|truncatechars:100 }}</p>
        </div>
        {% endif %}

        <!-- Action Buttons -->
        <div class="d-flex gap-2">
            <a href="{% url 'cvbuilder:cv_detail' cv.id %}" class="btn btn-outline-primary btn-sm flex-fill">
                <i class="fas fa-eye me-1"></i>{% trans "View" %}
            </a>
            <a href="{% url 'cvbuilder:cv_edit' cv.id %}" class="btn btn-outline-secondary btn-sm flex-fill">
                <i class="fas fa-edit me-1"></i>{% trans "Edit" %}
            </a>
        </div>
    </div>
    
    <!-- CV Footer -->
    <div class="card-footer bg-transparent border-0 pt-0">
        <div class="d-flex justify-content-between align-items-center">
            <small class="text-muted">
                {% if cv.updated_at != cv.created_at %}
                {% trans "Updated" %}: {{ cv.updated_at|date:"d.m.Y" }}
                {% else %}
                {% trans "Newly created" %}
                {% endif %}
            </small>
            <a href="{% url 'cvbuilder:cv_export_pdf' cv.id %}" class="btn btn-primary btn-sm">
                <i class="fas fa-download me-1"></i>PDF
            </a>
        </div>
    </div>
</div>